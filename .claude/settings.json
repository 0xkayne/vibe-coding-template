{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'CMD=$(jq -r \".tool_input.command // empty\"); if echo \"$CMD\" | grep -qEi \"rm\\s+-rf\\s+/|DROP\\s+(TABLE|DATABASE)|git\\s+push.*-f|git\\s+push.*force|truncate\\s+table\"; then echo \"{\\\"decision\\\": \\\"deny\\\", \\\"reason\\\": \\\"Destructive command detected. Please confirm with the user before proceeding.\\\"}\" >&2; exit 2; fi'"
          }
        ]
      },
      {
        "matcher": "Edit|MultiEdit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'FILE=$(jq -r \".tool_input.file_path // empty\"); if echo \"$FILE\" | grep -qE \"\\.env$|\\.env\\.local$|secrets|credentials\"; then echo \"{\\\"decision\\\": \\\"deny\\\", \\\"reason\\\": \\\"Editing secrets/env files requires explicit user approval.\\\"}\" >&2; exit 2; fi'"
          }
        ]
      }
    ]
  }
}